<!DOCTYPE HTML>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Herramientas IA</title>
    <link rel="icon" th:href="@{/imagenes/isologo.png}" type="image/x-icon">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap" rel="stylesheet">

    <link rel="stylesheet" th:href="@{/css/variables.css}"/>
    <link rel="stylesheet" th:href="@{/css/base.css}"/>
    <link rel="stylesheet" th:href="@{/css/home.css}"/>
    <link rel="stylesheet" th:href="@{/css/archivos-subidos.css}"/>

</head>
<body>
<header>
    <nav th:replace="templates/nav :: nav"></nav>
</header>
<main class="contenedor_general">
    <aside class="columnaUno">
        <div class="estructura">
            <img class="user"
                 th:src="@{${usuario.fotoPerfil != null ? '/' + usuario.fotoPerfil : '/imagenes/user.png'}}"
                 alt="Foto de perfil">
            <h2 class="palabra" th:text= "${usuario.nombre}"></h2>
            <h2 class="palabra" th:text= "${usuario.apellido}"></h2>
            <ul>
                <li class="titulo" th:text="${usuario.carrera != null ? usuario.carrera.nombre : 'Sin carrera'}">Carrera</li>
            </ul>
        </div>
        <div class="estructura box_columnaUno">
            <a href=""><img th:src="@{/imagenes/grupos.png}"> Grupos</a>
            <a href=""><img th:src="@{/imagenes/guardados.png}"> Elementos guardados</a>
            <!--se lo agrego aca... despues vemos bien donde lo ubicamos-->
            <a th:href="@{/herramientas-IA.html}" class="btn_subir_archivos"><img th:src="@{/imagenes/pdf-icon.png}">Herramientas IA</a>
            <!--<a href=""><img src="../../../resources/core/imagenes/grupos.png"> Grupos</a>
            <a href=""><img src="../../../resources/core/imagenes/guardados.png"> Elementos guardados</a>-->
        </div>
    </aside>
    <section class="columnaDos">

        <article class="estructura">
            <h3>Subir archivos pdf</h3>
            <form th:action="@{/herramientas-IA.html}" method="POST" enctype="multipart/form-data">
                <input type="file" name="archivo" accept="application/pdf" required />
                <button class="btn btn-ia" type="submit">Subir PDF</button>
            </form>
            <p th:if="${mensaje}" th:text="${mensaje}" style="color: green;"></p>
        </article>
        <article class="estructura">

            <div class="modo-selector">
                <h3>Mis archivos subidos</h3>
                <label>
                    <input type="checkbox" id="modoBorradoToggle">
                    Seleccionar archivos para borrar
                </label>
            </div>

            <div class="archivos-subidos">
                <p id="instruccion-principal">Selecciona el archivo con el que deseas generar el resumen</p>
                <form th:action="@{/herramientas-IA/resumen.html}" method="POST">
                    <ul>
                        <li class="lista-archivos" th:each="archivo,iterStat : ${archivos}">

                            <input type="radio" name="archivoSeleccionado" th:id="'archivo__' + ${iterStat.index}" th:value="${archivo}" th:checked="${iterStat.index == 0}" />
                            <input type="checkbox" name="archivosABorrar" class="checkbox-borrado" th:id="'check__' + ${iterStat.index}" th:value="${archivo}" disabled style="display: none;"/>

                            <img th:src="@{/imagenes/pdf-icon.png}" alt="PDF" class="icono-pdf">

                            <label th:for="'radio__' + ${iterStat.index}" >
                                <a th:href="@{'/archivos_pdf/' + ${archivo}}" target="_blank" th:text="${archivo}"></a>
                            </label>

                        </li>
                    </ul>
                    <div class="botones-accion">
                        <div class="seleccionar-todos-container" style="display: none;">
                            <input type="checkbox" id="seleccionarTodosCheck">
                            <label for="seleccionarTodosCheck">Seleccionar todos</label>
                        </div>
                    <button class="btn btn-ia" type="submit">Generar resumen con IA</button>
                    <button class="btn btn-ia" type="button" id="btnBorrarSeleccionados" disabled>Borrar seleccionados</button>
                    </div>
                </form>
            </div>
        </article>

        <article class="estructura">
            <h3>Resumen generado a partir del pdf subido</h3>
            <div class="resumen-ia-display" th:if="${resumen}" th:utext="${resumen}">
            </div>
            <!--compartir-->
            <form th:action="@{/herramientas-IA/compartir-resumen}" method="post" enctype="multipart/form-data" accept-charset="UTF-8">
                <!-- Este es el resumen que se pasa desde la IA -->
                <textarea name="resumen" th:text="${resumen}" hidden></textarea>

                <!-- Nombre del archivo HTML generado -->
                <input type="hidden" name="archivoNombre" th:value="${archivoNombre}" />

                <!-- Campo para subir el archivo HTML -->
                <input type="file" name="archivo" accept=".html" />

                <button type="submit">Compartir resumen</button>
            </form>


            <button class="btn btn-ia" disabled>Guardar como pdf</button>
        </article>
    </section>

    <aside class="columnaTres">
        <div class="estructura">
            <h2>Alumnos cursando...</h2>
            <p>Ingenier√≠a en Sistemas</p>
            <div class="recomendaciones_users" >
                <img class="user2" th:src="@{/imagenes/user2.png}">
                <img class="user2" th:src="@{/imagenes/user2.png}">
                <img class="user2" th:src="@{/imagenes/user2.png}">
                <img class="user2" th:src="@{/imagenes/user2.png}">
                <img class="user2" th:src="@{/imagenes/user2.png}">
            </div>
        </div>
    </aside>

</main>

<script type="module" th:src="@{js/tema.js}"></script>

</body>
</html>