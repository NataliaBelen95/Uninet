<!DOCTYPE HTML>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Home</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap" rel="stylesheet">

    <link rel="stylesheet" th:href="@{/css/home.css}"/>
    <link rel="stylesheet" href="../../../resources/core/css/home.css"/>
</head>
<body>
<header>
    <nav class="navbar">
        <a href="#"><img class="isologo" th:src="@{/imagenes/isologo.png}"></a>
        <!--<a href="#"><img class="isologo" src="../../../resources/core/imagenes/isologo.png"></a>-->
        <div>
            <a href="/spring/miPerfil">Mi Perfil</a>
            <a href="/spring/miPerfil">Notificaciones</a>
            <a href="/spring/miPerfil">Mensajes</a>
        </div>
    </nav>
</header>
<main class="contenedor_general">
    <aside class="estructura columnaUno">
        <div>
            <img class="user" th:src="@{/imagenes/user.png}">
            <!--<img class="user" src="../../../resources/core/imagenes/user.png">-->
            <h2 class="palabra" th:text= "${usuario.nombre}"></h2>
            <h2 class="palabra" th:text= "${usuario.apellido}"></h2>
            <ul>
                <li class="titulo" th:text="${usuario.carrera != null ? usuario.carrera.nombre : 'Sin carrera'}">Carrera</li>
            </ul>
        </div>
        <div>
            <p>blablaba</p>
            <p>blablaba</p>
            <p>blablaba</p>
            <a href="#" class="ver_mas">Conocer más...</a>
        </div>
        <div>
            <ul>
                <li>Archivos</li>
                <li>Grupos</li>
            </ul>
        </div>
    </aside>
    <section class="columnaDos">
        <article class="estructura">
            <form class="box_comentario" method="POST" action="/spring/publicaciones">
                <input name="descripcion" id="publicacion" placeholder="Escribe algo"/>
                <div class="box_publi_botones">
                    <button>attach_file</button>
                    <button>Visibilidad</button>
                    <button type="submit" name="nueva-publicacion">Publicar</button>
                </div>
            </form>
        </article>
        <article class="estructura">
            <div class="botones-quePublisVer">
                <div class="ordenar-por">
                    <p class="ordernar-por_text">Ordenar Por</p><span><button>Ordenar por</button></span>
                </div>
                <div class="container_puicacionesUsuarios" th:each="dtopubli : ${datosPublicaciones}">
                    <h2 th:text="${dtopubli.nombreUsuario + ' ' + dtopubli.apellidoUsuario}"> </h2>
                    <p class="texto" th:text="${dtopubli.nombreUsuario}"> </p>
                    <p class="texto" th:text="${dtopubli.descripcion}">
                    </p>
                    <div th:each="dtopubli : ${datosPublicaciones}" class="publicacion">

                        <!-- Formulario para dar like -->
                        <form method="POST" th:action="@{/publicacion/darLike/{id}(id=${dtopubli.id})}">
                            <button type="submit">
                                <img class="user2" th:src="@{/imagenes/like.png}" alt="Like">
                            </button>
                            <span th:text="${dtopubli.cantLikes}"></span>
                        </form>


                        <!-- Botón para mostrar comentarios -->
                        <button type="button" class="verComentariosBtn">Ver Comentarios</button>

                        <!-- Contenedor de comentarios oculto inicialmente -->
                        <div class="contenedor_comentarios" style="display: none;">
                            <!-- Lista de comentarios -->
                            <div th:each="comentario : ${dtopubli.comentarios}" class="comentario">
                                <strong th:text="${comentario.nombreUsuario + ' ' + comentario.apellidoUsuario}"></strong>
                                <p th:text="${comentario.texto}"></p>
                            </div>
                        </div>

                        <!-- Botón para mostrar formulario de comentario -->
                        <button type="button" class="comentarBtn">
                            <img class="user2" th:src="@{/imagenes/comentar.png}" alt="Comentar">
                        </button>

                        <!-- Formulario para comentar -->
                        <form method="POST"
                              th:action="@{/publicacion/comentar/{id}(id=${dtopubli.id})}"
                              class="formComentario"
                              style="display: none;">
                            <textarea name="texto" rows="3" cols="40" placeholder="Escribe tu comentario..."></textarea>
                            <br>
                            <button type="submit">Enviar</button>
                        </form>
                    </div>

                    <!-- JavaScript para manejar interacción -->
                    <script>
                        document.addEventListener("DOMContentLoaded", function () {
                            // Mostrar comentarios
                            document.querySelectorAll(".verComentariosBtn").forEach(function (btn) {
                                btn.addEventListener("click", function () {
                                    const contenedor = btn.parentElement.querySelector(".contenedor_comentarios");
                                    contenedor.style.display = contenedor.style.display === "none" ? "block" : "none";
                                });
                            });

                            // Mostrar formulario para comentar
                            document.querySelectorAll(".comentarBtn").forEach(function (btn) {
                                btn.addEventListener("click", function () {
                                    const form = btn.parentElement.querySelector(".formComentario");
                                    form.style.display = "block";
                                    form.querySelector("textarea").focus();
                                });
                            });
                        });
                    </script>

                            <button type="submit"><img class="user2" th:src="@{/imagenes/guardar.png}"></button>
                            <!--<button type="submit"><img class="user2" src="../../../resources/core/imagenes/like.png"></button>-->
                            <!--<button type="submit"><img class="user2" src="../../../resources/core/imagenes/comentar.png"></button>-->
                            <!--<button type="submit"><img class="user2" src="../../../resources/core/imagenes/guardar.png"></button>-->
                        </div>










                </div>
            </div>
        </article>
    </section>
    <aside class="estructura columnaTres">
        <div class="container_profile">
            <h2>Aumnos cursando...</h2>
            <p>Ingeniería en Sistemas</p>
        </div>
        <div class="recomendaciones_users" >
            <img class="user2" th:src="@{/imagenes/user2.png}">
            <img class="user2" th:src="@{/imagenes/user2.png}">
            <img class="user2" th:src="@{/imagenes/user2.png}">
            <img class="user2" th:src="@{/imagenes/user2.png}">
            <img class="user2" th:src="@{/imagenes/user2.png}">
            <!--<img class="user2" src="../../../resources/core/imagenes/user2.png">
            <img class="user2" src="../../../resources/core/imagenes/user2.png">
            <img class="user2" src="../../../resources/core/imagenes/user2.png">
            <img class="user2" src="../../../resources/core/imagenes/user2.png">
            <img class="user2" src="../../../resources/core/imagenes/user2.png">-->
        </div>
    </aside>
</main>
<script type="text/javascript" th:src="@{webjars/bootstrap/5.2.0/js/bootstrap.min.js}"></script>
</body>
</html>